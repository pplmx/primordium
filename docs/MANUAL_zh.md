# Primordium 用户手册 (原初之境)

欢迎来到 **Primordium**。这是一个先进的人工生命模拟系统，实体在这里进化、形成社会，并在动态的生态系统中为生存而挣扎。本手册将指导您了解模拟机制和控制方法。

---

## 🚀 快速开始

### 运行模式

Primordium 在两种环境中运行：

1. **终端 (TUI)**：经典、高性能的文本界面体验。

   ```bash
   primordium
   ```

2. **Web 浏览器 (WASM)**：通过 WebAssembly 实现的现代图形界面。

---

## 🎮 控制指南

### 全局按键

| 按键 | 动作 |
| ----- | --------- |
| `q` | **退出** 模拟 |
| `Space` | **暂停/继续** 模拟 |
| `b` | 切换 **神经网络可视化** |
| `h` | 切换 **帮助/控制** 菜单 |
| `x` | 触发 **基因风暴** (全球大突变) |
| `m` | 手动诱发选中个体的 **突变** |
| `k` | 执行 **神罚** (抹除) 选中个体 |
| `p` | 诱发 **转生** (随机 DNA) 选中个体 |
| `! @ # $ % ^` | 选择 **地形笔刷** (平原、山脉、河流、绿洲、墙壁、荒地) |
| `Shift+K` | 切换 **全球热浪** 灾难 |
| `l` | 触发 **大规模灭绝** (清除 90% 种群) |
| `r` | 触发 **资源爆发** (生成食物) |
| `+` / `-`| 加速 / 减速模拟 |

### 鼠标控制

| 输入 | 动作 |
| ----- | --------- |
| `左键点击` | 选择并锁定个体 |
| `左键拖拽` | 使用选中的笔刷 **绘画地形** |
| `右键点击`| 在点击处注入食物簇 |

---

## 👁️ 界面指南

### 实体与状态

实体由符号表示，指示其当前生理状态：

- `●` **觅食**：标准状态，正在寻找资源。
- `♦` **狩猎**：攻击状态，试图捕食其他实体。
- `♥` **交配**：高能量状态，准备繁殖。
- `†` **饥饿**：危急能量状态 (< 20%)，死亡风险极高。
- `♣` **分享**：利他状态，向附近的部落成员提供能量。
- `☣` **感染**：携带病原体，会持续损耗能量。
- `◦` **幼体**：尚未发育成熟，无法进行繁殖。

### 颜色 (部落)

实体根据其 **基因部落** 显示颜色。

- 颜色相近的实体属于同一个 **部落**。
- 部落成员 **不** 会互相攻击。
- 部落成员可能会分享能量。

### 地形

- ` ` **平原**：标准移动速度。
- `≈` **河流** (蓝色)：移动速度更快 (1.5x)。
- `▲` **山脉** (灰色)：移动缓慢 (0.5x)，无食物生长。
- `◊` **绿洲** (青绿色)：食物生成率 3x。
- `░` **荒芜** (棕色)：过度放牧或灾难后的土地，移动减速且食物极少。
- `█` **墙壁** (深灰色)：不可逾越的物理障碍，实体会发生反弹。
- `*` **食物** (绿色)：能量源。

---

## 🧬 进化机制

### 大脑 (循环神经网络)

每个实体都拥有一个代代进化的 **循环神经网络** (RNN-lite)。

- **输入 (传感器)**:
    - 环境输入 (视觉、能量、信息素、密度)
    - **记忆输入**: 6个输入端用于保留上一时刻的内部状态，实现行为连贯性。
- **输出 (动作)**:
    - 移动、爆发、攻击、分享。

### 遗传学

通过遗传算法产生后代，混合父母的 DNA 并发生轻微突变。

---

## 🌍 生态系统

### 天气与循环

- **昼夜循环**：世界在白昼与黑夜间交替。
    - **白昼**：高光照强度驱动食物生长。
    - **黑夜**：实体进入“休息”状态，代谢降低 40%。

### 灾难 (Disasters)

- **沙尘暴 (Dust Bowl)**：热浪期间且种群密集时触发，导致平原荒芜化，损耗土地肥力。

---

## ⚔️ 游戏模式 (Game Modes)

使用 `--gamemode` 参数启动：`standard` (标准), `coop` (合作), `battle` (大逃杀)。

---

## 🌌 多人联机与网络

Primordium 支持 **全球蜂巢式迁移 (Global Hive Migration)**。实体可以通过中央中继服务器在不同用户的模拟实例之间进行跨界迁移。

### 中继服务器
- **默认端口**: `3000`
- 中继服务器负责将迁移的实体广播给所有已连接的对等端。

### 如何迁移
1. 确保您的模拟程序已连接到中继服务器。
2. 当实体 **移动到世界边缘之外** 时，即会触发迁移。
3. 它将从您的屏幕上消失，并出现在另一位用户的宇宙中。

---

## 📚 技术维基 (Technical Wiki)

- [遗传学与 HexDNA](../docs/wiki/GENETICS.md)
- [神经网络架构](../docs/wiki/BRAIN.md)
- [生态系统公式](../docs/wiki/ECOSYSTEM.md)

---
*更新时间: 2026-01-21*

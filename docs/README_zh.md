# Primordium (原初之境)

[English](../README.md) | [修订历史](./CHANGELOG_zh.md)

> *代码演化，硅基共鸣*

**Primordium** 是一款与硬件深度耦合的人工生命模拟器。它在你的终端中构建了一个数字生态系统，在这里，自然的法则由你电脑的实时性能直接塑造。

![状态](https://img.shields.io/badge/状态-稳定版-brightgreen)
![构建工具](https://img.shields.io/badge/构建环境-Rust-orange)
![授权](https://img.shields.io/badge/授权-MIT-blue)

---

## 🎯 愿景

Primordium 是一场关于**涌现复杂度**的实验。它将你的宿主机转化为数字神明：

- **CPU 负载** 转化为环境的气候压力。
- **内存占用** 控制资源的稀缺程度。
- **神经网络** 随着生物适应你硬件的独特运行特征而不断进化。

---

## 🌊 核心机制：硬件共鸣

模拟环境通过 `sysinfo` 实时获取计算机指标，并将其转化为生存压力。

### 🌡️ 气候 (CPU 耦合)

你的 CPU 使用率决定了所有数字生命的代谢速度。机器负载越高，生命消耗能量的速度越快。

| CPU 使用率 | 气候状态 | 代谢倍率 | 生存影响 |
| ----------- | ---------- | ---------- | ---------- |
| 0-30%     | 🌡️ 温和  | ×1.0    | 基准生存环境 |
| 30-60%    | 🔥 温暖  | ×1.5    | 能量消耗加速 |
| 60-80%    | 🌋 炎热  | ×2.0    | 高代谢压力 |
| 80-100%   | ☀️ 酷热  | ×3.0    | 大规模饥荒风险 |

### 🌾 资源稀缺 (RAM 耦合)

内存占用决定了食物的生成频率。高内存占用会模拟资源匮乏的饥荒环境。

---

- [User Manual (English)](../docs/MANUAL.md)
- [用户手册 (中文)](../docs/MANUAL_zh.md)

## ✨ 功能特性

### 🧠 神经觉醒与并行智能

每个个体都拥有一个**动态图结构 (NEAT-lite)** 大脑。通过自然选择，生物会学会狩猎、集群协同和能量管理。

- **可进化拓扑**: 大脑不再是静态的。通过结构变异，生物可以生长新的神经元和连接，以适应复杂的生存环境。
- **效率压力**: 结构复杂性伴随着代谢成本（每个节点 0.02，每个连接 0.005），确保只有最有效的认知结构能留存。
- **亲缘识别**: 实体可感知同谱系成员的相对质心 (**KX**, **KY**)，从而演化出复杂的集群迁徙行为。
- **语义语言**: 主动化学信号 (**SA**, **SB**) 为进化的社交协同提供了信息传递基质。
- **语言演化 (Phase 48)**: 实体拥有 **听觉** (输入) 与 **发声** (输出) 通道。实时声波通过 `SoundGrid` 在物理空间中扩散，支持警报鸣叫、集群诱导等涌现行为。
- **终身学习 (Phase 47)**: 引入赫布学习法则 (Hebbian plasticity)，大脑权重可根据个体的实时反馈（食物/痛觉）进行动态调整。
- **极大规模并行 (Phase 41)**: 由 **Rayon** 驱动，采用“提案解复用 (Proposal Unzipping)”模拟管线，支持多核 CPU 上 10,000+ 实体的无抖动流畅模拟。

### 👥 社交与生活史策略

- **特化阶级 (Phase 53)**: 根据个体的行为历史和基因偏好，生物可演化为 **战士** (高伤害、高能耗)、**工程师** (高效地形改造) 或 **供给者** (高效能量分享) 等专门阶级。
- **R/K 选择策略**: 生物在“多而弱的后代”（R策略）与“少而精的继承者”（K策略）之间进行演化权衡。
- **种间共生 (Phase 54)**: 不同谱系间可建立互惠链接，获得代谢减免，并支持 **跨物种杂交** (基因交叉)。
- **群体防御**: 同谱系成员在附近时，可共同抵御捕食伤害（伤害减免）。
- **谱系持久化**: 全球 **谱系注册表 (Lineage Registry)** 跨会话追踪各大家族的历史兴衰。

### 🦠 病原体与寄生操控

- **动态变异**: 病原体自然产生并不断进化，影响宿主的健康、能量与繁殖。
- **寄生行为操控 (Phase 55)**: 高级病原体可劫持宿主神经回路，强制其做出特定行为（如强制攻击、强制发声），以加速自身的传播。

### ⚡ 神力交互 v2 (Divine Interface)

- **地形编辑器**: 支持 **鼠标拖拽** 实时在地图上绘制山脉、河流和墙壁。
- **精准干预**: 支持对选中个体执行 **变异 (M)**、**抹除 (K)** 或 **转生 (P)** 操作。
- **考古学与化石 (Phase 40)**: 持久化**化石记录** (`logs/fossils.json.gz`) 高效保存传奇基因组。周期性**历史快照**支持时空旅行式浏览。
- **上帝模式**: 通过宏命令手动触发全球热浪、资源爆发或大规模灭绝。

### 🦁 顶级掠食者与有性繁殖

- **捕食动态**：生物可进化出攻击性。**战士阶级**与**战争地带**可施加致命的伤害增益。
- **基因交叉**：有性繁殖支持与配偶进行神经特征交换。共生伙伴可产出跨谱系杂交种。
- **HexDNA 协议**：通过文本文件导出（`C` 键）和导入（`V` 键）生物基因组。

### 📊 全知之眼

- **生命之树 (阶段 34)**: 实时谱系可视化，追踪前 5 大优势王朝。
- **纪元系统**：由种群驱动的叙事引擎，追踪世界纪元（创世、扩张、衰落等）。
- **阶级可视化**: TUI 实时显示 11 个输出节点激活强度及阶级特化进度。

### 🏔️ 生态动力学

- **地形系统**：山脉（▲减速）、河流（≈加速/湿润）、绿洲（◊食物丰富）。
- **涌现工程 (Phase 52)**: 实体可自主 **挖掘** 运河或 **建造** 保护性 **巢穴 (Ω)**。巢穴提供代谢减免和后代发育加成。
- **水分耦合**: 人工运河可提升周围土壤肥力，开启生物改造环境的反馈循环。
- **季节循环**：春/夏/秋/冬影响代谢和食物供应。
- **地理压力**: 基于地形的资源分布产生涌现式迁徙模式。

### 👥 社会结构

- **信息素系统**：食物踪迹吸引觅食者，危险信息素警告掠食者。
- **部落形成**：颜色相似的实体形成保护性部落（同部落不互相攻击）。
- **领地行为**：实体在出生地附近更具攻击性。
- **能量分享**：高能量实体可与饥饿邻居分享能量 (♣)。
- **高级阶层 (Phase 49)**：阿尔法领袖影响移动；过度拥挤的部落会发生分裂。

### 🌌 全球蜂巢与多重宇宙

- **P2P 分布式演化**: 实体通过高性能的 **Axum** 中继服务器在不同用户的模拟宇宙之间自由迁移。
- **节点自动发现**: 集成实时 REST API，支持全球模拟状态监控与节点列表自动维护。
- **HexDNA 协议**: 统一遗传协议，确保生物在跨宇宙迁移时保持 100% 的性状还原度。

### 📜 演化账本与区块链

- **历史日志**：所有出生、死亡和环境事件实时流式记录为 JSONL 格式。
- **永恒证明**：演化数据集锚定至 **比特币区块链**，提供不可篡改的演化证明。

### ⚡ 性能与稳定性

- **基于组件的实体 (CBE)**: 逻辑分组属性为 Physics, Metabolism, Health 和 Intel。
- **系统化解耦**: 单体更新逻辑拆分为专业化系统（感知、行动、生物、社交）。
- **多线程流水线**: 全并行更新支持 10,000+ 超大规模种群模拟，无抖动性能。
- **严苛质量门禁**: 100% Clippy 合规，40+ 单元与集成测试保障。
- **空间哈希 (Spatial Hashing)**: 无锁并行空间分区，支持高密度种群流畅运行。

---

## 🚀 快速开始

确保你已安装 [Rust](https://rustup.rs/)。

```bash
# 克隆并进入目录
git clone https://github.com/pplmx/primordium.git
cd primordium

# 运行标准模式
cargo run --release

# 运行画境模式 (极简)
cargo run --release -- --mode screensaver
```

---

## ⌨️ 交互快捷键

| 按键 | 动作 |
| ----- | ------- |
| `Q` | 退出模拟 |
| `Space` | 暂停 / 恢复 |
| `A` | 切换 **谱系视图** (生命之树) |
| `Shift+A` | 导出谱系树 (DOT 格式) |
| `Y` | 切换 **考古学与化石记录** |
| `[` / `]` | **时空旅行** (切换历史快照) |
| `B` | 开关神经网络热图 |
| `H` | 开关交互帮助菜单 |
| `X` | 触发 **基因风暴** (全球大突变) |
| `M` | 手动诱发选中个体的变异 |
| `K` | 抹除 (Smite) 选中个体 |
| `P` | 随机化 (转生) 选中个体的 DNA |
| `! @ # $ % ^` | 选择地形笔刷 (平原、山脉、河流、绿洲、墙壁、荒地) |
| `Shift+K` | 切换 **全球热浪** 灾难 |
| `L` | 触发 **大规模灭绝** (清除 90% 种群) |
| `R` | 触发 **资源爆发** (瞬间生成 100 食物) |
| `+` / `-`| 加速 / 减速模拟 |
| `鼠标左键` | 选择个体 / **按住并拖拽以绘画地形** |
| `鼠标右键` | 在点击处注入食物簇 |

---

## 🌱 哲学

每一次运行 Primordium 都是独一无二的。你特定的硬件工作负载创造了绝无仅有的演化压力。每一个谱系都弥足珍贵，每一次灭绝都是这片"原初之境"给予的启示。
